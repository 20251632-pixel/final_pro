# --------------------------------------------------------------
#  ğŸ“ ë°•ì›”ì²œ ì§„ë¡œ ìƒë‹´ ë§¤ì¹­ í”„ë¡œê·¸ë¨ (Colab ì‹¤í–‰ìš©)
#  ì´ˆë³´ìë„ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ë§¤ìš° ìƒì„¸í•œ ì£¼ì„ì„ í¬í•¨í•¨
# --------------------------------------------------------------

# ëª¨ë“ˆ import: í”„ë¡œê·¸ë¨ì—ì„œ ì¶”ê°€ ê¸°ëŠ¥ì„ ê°€ì ¸ì˜¤ëŠ” ê³¼ì •
import datetime  # í˜„ì¬ ë‚ ì§œ/ì‹œê°„ì„ ê°€ì ¸ì˜¤ê±°ë‚˜ ì €ì¥í•  ë•Œ ì‚¬ìš©
import random    # Zoom ë¯¸íŒ… IDë¥¼ ëœë¤ìœ¼ë¡œ ìƒì„±í•˜ê¸° ìœ„í•´ ì‚¬ìš©


# --------------------------------------------------------------
# 1) ìƒë‹´ ë¶„ì•¼ ë° ì„¸ë¶€ ì£¼ì œë¥¼ ì €ì¥í•˜ëŠ” ìë£Œ êµ¬ì¡° (ë”•ì…”ë„ˆë¦¬ + ë¦¬ìŠ¤íŠ¸)
# --------------------------------------------------------------
# fields ë”•ì…”ë„ˆë¦¬ëŠ” "ë¶„ì•¼ ì´ë¦„"ì„ keyë¡œ ì‚¼ê³ ,
# ê° ë¶„ì•¼ë³„ ì„¸ë¶€ ìƒë‹´ í•­ëª© ë¦¬ìŠ¤íŠ¸ë¥¼ valueë¡œ ê°€ì§€ê³  ìˆìŒ.
# ì„¸ë¶€ í•­ëª©ì€ ë‹¤ì‹œ ë”•ì…”ë„ˆë¦¬ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŒ.

fields = {
    "í’ˆì§ˆê²½ì˜": [
        {"id": 1, "name": "í’ˆì§ˆë³´ì¦", "desc": "ê³µì •Â·ì œí’ˆì´ ê¸°ì¤€ì„ ì˜ ì§€í‚¤ëŠ”ì§€ ê´€ë¦¬í•¨"},
        {"id": 2, "name": "í’ˆì§ˆê´€ë¦¬", "desc": "ê²€ì‚¬Â·ì¸¡ì • ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ ë¬¸ì œì  í™•ì¸"},
        {"id": 3, "name": "ê³ ê° í´ë ˆì„ ë¶„ì„", "desc": "VOC ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ ë¶ˆë§Œ ì›ì¸ íŒŒì•…"},
    ],
    "ê²½ì˜ê³¼í•™": [
        {"id": 1, "name": "ì‹œë®¬ë ˆì´ì…˜ ëª¨ë¸ë§", "desc": "ê³µì •/ì¬ê³ /ëŒ€ê¸°ì—´ ë“±ì„ ëª¨ì˜ì‹¤í—˜í•¨"},
        {"id": 2, "name": "ë¬¼ë¥˜Â·SCM ë¶„ì„", "desc": "ìˆ˜ìš”ì˜ˆì¸¡Â·ë°°ì°¨ ìµœì í™” ë“± ë¬¼ë¥˜ íš¨ìœ¨ ê°œì„ "},
        {"id": 3, "name": "ìƒì‚°ê³„íš/ìŠ¤ì¼€ì¤„ë§", "desc": "ì–¸ì œ ë¬´ì—‡ì„ ìƒì‚°í• ì§€ ê³„íší•˜ëŠ” ì—…ë¬´"},
    ],
    "ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤": [
        {"id": 1, "name": "ë°ì´í„° ë¶„ì„/ì‹œê°í™”", "desc": "íŒŒì´ì¬Â·Power BIë¡œ ë°ì´í„° ë¶„ì„"},
        {"id": 2, "name": "ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ë§", "desc": "íšŒê·€Â·ë¶„ë¥˜ ë“± ì˜ˆì¸¡ ëª¨ë¸ ë§Œë“¤ê¸°"},
        {"id": 3, "name": "í†µê³„ ë¶„ì„", "desc": "ê°€ì„¤ê²€ì •Â·íšŒê·€ ë“± í†µê³„ ê¸°ë°˜ ë¬¸ì œ í•´ê²°"},
    ],
}


# --------------------------------------------------------------
# 2) ìƒë‹´ ê°€ëŠ¥í•œ êµìˆ˜(ìƒë‹´ì‚¬) ì •ë³´
# --------------------------------------------------------------
# professors ë”•ì…”ë„ˆë¦¬ëŠ” êµìˆ˜ ì´ë¦„ì„ keyë¡œ ë‘ê³ 
# ì „ë¬¸ë¶„ì•¼, ì—°êµ¬ì‹¤, ì´ë©”ì¼ ë“±ì„ valueë¡œ ì €ì¥í•¨.

professors = {
    "ê¹€í’ˆì§ˆ": {
        "field": "í’ˆì§ˆê²½ì˜",
        "specialty": "í’ˆì§ˆë³´ì¦Â·ê³ ê°ë§Œì¡±Â·í’ˆì§ˆì‹œìŠ¤í…œ êµ¬ì¶•",
        "email": "kimq@example.com",
        "office": "ê³µëŒ€1 305í˜¸",
        "intro": "ì œì¡°ì—… í’ˆì§ˆíŒ€ ì‹¤ë¬´ ê²½í—˜ì´ í’ë¶€í•œ êµìˆ˜ë‹˜",
    },
    "ì´ê³¼í•™": {
        "field": "ê²½ì˜ê³¼í•™",
        "specialty": "ì‹œë®¬ë ˆì´ì…˜Â·ìµœì í™”Â·ìƒì‚°/ë¬¼ë¥˜ ì‹œìŠ¤í…œ",
        "email": "leeor@example.com",
        "office": "ê³µëŒ€2 210í˜¸",
        "intro": "ê²½ì˜ê³¼í•™ ê¸°ë°˜ ë¬¸ì œ í•´ê²° ì „ë¬¸ê°€",
    },
    "ë°•ë°ì´í„°": {
        "field": "ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤",
        "specialty": "íŒŒì´ì¬ ë¶„ì„Â·ë¨¸ì‹ ëŸ¬ë‹Â·í†µê³„ ëª¨ë¸ë§",
        "email": "parkds@example.com",
        "office": "ìœµí•©ê´€ 501í˜¸",
        "intro": "ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì • ì „ë¬¸ê°€ êµìˆ˜ë‹˜",
    },
}

# ë¶„ì•¼ë³„ë¡œ ì—°ê²° ê°€ëŠ¥í•œ êµìˆ˜ ëª©ë¡
field_to_professors = {
    "í’ˆì§ˆê²½ì˜": ["ê¹€í’ˆì§ˆ"],
    "ê²½ì˜ê³¼í•™": ["ì´ê³¼í•™"],
    "ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤": ["ë°•ë°ì´í„°"],
}


# --------------------------------------------------------------
# 3) ìƒë‹´ ê°ì²´(Class) ì •ì˜ - OOP ì‚¬ìš©
# --------------------------------------------------------------
# í´ë˜ìŠ¤ëŠ” "ìƒë‹´ ì •ë³´"ë¥¼ í•˜ë‚˜ì˜ ë¬¶ìŒ(ê°ì²´)ìœ¼ë¡œ ë§Œë“¤ì–´ ì €ì¥í•˜ê¸° ìœ„í•œ ì„¤ê³„ë„ ê°™ì€ ì—­í• ì„ í•¨.

class Consultation:
    """í•˜ë‚˜ì˜ ìƒë‹´ ì˜ˆì•½ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í´ë˜ìŠ¤"""

    def __init__(self, student_name, field, subtopic, mode, date_str, time_str, professor, zoom_link=None):
        # self.xxx ëŠ” ê°ì²´ ë‚´ë¶€ì— ë³€ìˆ˜ë¥¼ ì €ì¥í•˜ëŠ” ë°©ì‹
        self.student_name = student_name
        self.field = field
        self.subtopic = subtopic
        self.mode = mode
        self.date_str = date_str
        self.time_str = time_str
        self.professor = professor
        self.zoom_link = zoom_link
        self.created_at = datetime.datetime.now()  # ìƒë‹´ ì˜ˆì•½ëœ ì‹œê°„ ìë™ ì €ì¥

    def summary(self):
        """ìƒë‹´ ë‚´ìš©ì„ ë³´ê¸° ì¢‹ê²Œ í•œ ì¤„ë¡œ ì •ë¦¬í•´ì„œ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜"""
        text = f"[{self.field} - {self.subtopic['name']}] {self.date_str} {self.time_str}, {self.mode}, ìƒë‹´ì‚¬: {self.professor}"

        # ì˜¨ë¼ì¸ ìƒë‹´ì¼ ë•Œë§Œ Zoom ë§í¬ ì¶”ê°€
        if self.mode == "ì˜¨ë¼ì¸(ZOOM)" and self.zoom_link:
            text += f" (Zoom: {self.zoom_link})"

        return text


# ìƒë‹´ ë°ì´í„°ë¥¼ ëˆ„ì  ì €ì¥í•  ë¦¬ìŠ¤íŠ¸
consultation_history = []


# --------------------------------------------------------------
# 4) í”„ë¡œê·¸ë¨ ê¸°ëŠ¥ í•¨ìˆ˜ë“¤ ì •ì˜
# --------------------------------------------------------------

def generate_zoom_link():
    """ëœë¤ ìˆ«ìë¥¼ í™œìš©í•´ Zoom íšŒì˜ ë§í¬ì²˜ëŸ¼ ë³´ì´ëŠ” ë¬¸ìì—´ì„ ìƒì„±"""
    meeting_id = random.randint(10**9, 10**10 - 1)
    return f"https://zoom.us/j/{meeting_id}"


def print_line():
    """í™”ë©´ êµ¬ë¶„ì„  ì¶œë ¥"""
    print("-" * 60)


def show_professor_info():
    """ì „ì²´ êµìˆ˜ ì •ë³´ ì¶œë ¥"""
    print_line()
    print("ğŸ“˜ ìƒë‹´ ê°€ëŠ¥í•œ êµìˆ˜ ëª©ë¡")
    print_line()

    for name, info in professors.items():
        print(f"ì´ë¦„: {name}")
        print(f"ì „ë¬¸ ë¶„ì•¼: {info['field']}")
        print(f"íŠ¹ê¸°: {info['specialty']}")
        print(f"ì´ë©”ì¼: {info['email']}")
        print(f"ì—°êµ¬ì‹¤: {info['office']}")
        print(f"ì†Œê°œ: {info['intro']}")
        print_line()


def select_field():
    """ìƒë‹´ ë°›ì„ ë¶„ì•¼ ì„ íƒ"""
    print_line()
    print("ğŸ‘‰ ìƒë‹´ ë°›ê³  ì‹¶ì€ ë¶„ì•¼ë¥¼ ì„ íƒí•˜ì„¸ìš”.")
    print("1) í’ˆì§ˆê²½ì˜\n2) ê²½ì˜ê³¼í•™\n3) ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤")

    choice = input("ë²ˆí˜¸ ì…ë ¥: ")

    if choice == "1":
        return "í’ˆì§ˆê²½ì˜"
    elif choice == "2":
        return "ê²½ì˜ê³¼í•™"
    elif choice == "3":
        return "ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤"
    else:
        print("âš ï¸ ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”.")
        return select_field()  # ì¬ê·€ í˜¸ì¶œë¡œ ë‹¤ì‹œ ì„ íƒ


def select_subtopic(field_name):
    """ì„¸ë¶€ ìƒë‹´ ì£¼ì œ ì„ íƒ"""
    print_line()
    print(f"ğŸ“‚ [{field_name}] ì„¸ë¶€ ìƒë‹´ ì£¼ì œë¥¼ ì„ íƒí•˜ì„¸ìš”!")

    # ë¶„ì•¼ì˜ ì„¸ë¶€ í•­ëª© ì¶œë ¥
    for item in fields[field_name]:
        print(f"{item['id']}) {item['name']} - {item['desc']}")

    choice = input("ë²ˆí˜¸ ì…ë ¥: ")

    # ìœ íš¨í•œ ë²ˆí˜¸ì¸ì§€ í™•ì¸
    for item in fields[field_name]:
        if str(item["id"]) == choice:
            return item

    print("âš ï¸ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë²ˆí˜¸ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”.")
    return select_subtopic(field_name)


def select_mode():
    """ìƒë‹´ ë°©ì‹ ì„ íƒ"""
    print_line()
    print("ìƒë‹´ ë°©ì‹ì„ ì„ íƒí•˜ì„¸ìš”!")
    print("1) ì˜¨ë¼ì¸(ZOOM)")
    print("2) ì˜¤í”„ë¼ì¸(ëŒ€ë©´)")

    choice = input("ë²ˆí˜¸ ì…ë ¥: ")

    if choice == "1":
        return "ì˜¨ë¼ì¸(ZOOM)"
    elif choice == "2":
        return "ì˜¤í”„ë¼ì¸(ëŒ€ë©´)"
    else:
        print("âš ï¸ ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤.")
        return select_mode()


def input_date_time():
    """ìƒë‹´ ë‚ ì§œì™€ ì‹œê°„ ì…ë ¥"""
    print_line()
    print("ğŸ“… ìƒë‹´ ë‚ ì§œì™€ ì‹œê°„ì„ ì…ë ¥í•˜ì„¸ìš”.")
    date_str = input("ë‚ ì§œ (ì˜ˆ: 2025-12-01): ")
    time_str = input("ì‹œê°„ (ì˜ˆ: 14:00): ")
    return date_str, time_str


def select_professor(field_name):
    """í•´ë‹¹ ë¶„ì•¼ì˜ êµìˆ˜ ì„ íƒ"""
    print_line()
    print(f"ğŸ“˜ [{field_name}] ìƒë‹´ ê°€ëŠ¥í•œ êµìˆ˜")

    candidates = field_to_professors.get(field_name, [])

    for idx, name in enumerate(candidates, start=1):
        info = professors[name]
        print(f"{idx}) {name} - {info['specialty']} ({info['email']})")

    choice = input("ë²ˆí˜¸ ì„ íƒ: ")

    try:
        idx = int(choice) - 1
        return candidates[idx]
    except:
        print("âš ï¸ ì˜ëª» ì„ íƒí•´ì„œ ê¸°ë³¸ êµìˆ˜ë¡œ ì§€ì •ë©ë‹ˆë‹¤.")
        return candidates[0]


def book_consultation():
    """ì‹¤ì œë¡œ ìƒë‹´ì„ ì˜ˆì•½í•˜ëŠ” ì „ì²´ ê³¼ì •"""
    print_line()
    print("ğŸ“Œ ì§„ë¡œ ìƒë‹´ ì˜ˆì•½ì„ ì‹œì‘í•©ë‹ˆë‹¤!")

    # ì´ë¦„ ì…ë ¥ (ê¸°ë³¸ê°’ ë°•ì›”ì²œ)
    name = input("ì´ë¦„ ì…ë ¥ (Enter ì‹œ 'ë°•ì›”ì²œ'): ")
    if name.strip() == "":
        name = "ë°•ì›”ì²œ"

    # ë‹¨ê³„ë³„ ì…ë ¥
    field_name = select_field()
    subtopic = select_subtopic(field_name)
    mode = select_mode()
    date_str, time_str = input_date_time()
    professor = select_professor(field_name)

    # ì˜¨ë¼ì¸ì´ë©´ Zoom ìƒì„±
    zoom_link = generate_zoom_link() if mode == "ì˜¨ë¼ì¸(ZOOM)" else None

    # ìƒë‹´ ê°ì²´ ìƒì„± í›„ ë¦¬ìŠ¤íŠ¸ì— ì €ì¥
    c = Consultation(name, field_name, subtopic, mode, date_str, time_str, professor, zoom_link)
    consultation_history.append(c)

    print_line()
    print("âœ… ìƒë‹´ ì˜ˆì•½ ì™„ë£Œ!")
    print(c.summary())
    print_line()


def show_history_and_stats():
    """ìƒë‹´ ê¸°ë¡ê³¼ í†µê³„(ê¸°ëŒ€íš¨ê³¼) ë³´ê¸°"""
    print_line()
    print("ğŸ“Š ìƒë‹´ ê¸°ë¡ ë° ì§€í‘œ")

    if not consultation_history:
        print("ì•„ì§ ìƒë‹´ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.")
        return

    # ìƒë‹´ ëª©ë¡ ì¶œë ¥
    for idx, c in enumerate(consultation_history, start=1):
        print(f"{idx}. {c.summary()}")

    print_line()
    print("ğŸ“ˆ ê°„ë‹¨ í†µê³„")

    field_counts = {}
    online = offline = 0

    for c in consultation_history:
        # ë¶„ì•¼ë³„ íšŸìˆ˜ ì €ì¥ (ë”•ì…”ë„ˆë¦¬ í™œìš©)
        field_counts[c.field] = field_counts.get(c.field, 0) + 1
        if c.mode == "ì˜¨ë¼ì¸(ZOOM)":
            online += 1
        else:
            offline += 1

    total = len(consultation_history)

    # ë¶„ì•¼ë³„ í†µê³„ ì¶œë ¥
    for field, count in field_counts.items():
        print(f"- {field}: {count}íšŒ")

    # ìƒë‹´ ë°©ì‹ í†µê³„
    print(f"- ì˜¨ë¼ì¸ ìƒë‹´: {online}íšŒ")
    print(f"- ì˜¤í”„ë¼ì¸ ìƒë‹´: {offline}íšŒ")

    print_line()
    print("ğŸ“Œ ê¸°ëŒ€íš¨ê³¼")
    print("âœ” ì—¬ëŸ¬ ìƒë‹´ì„ í•˜ë©´ì„œ í•™ìƒì€ ì§ë¬´ ì´í•´ë„ê°€ ë†’ì•„ì§")
    print("âœ” ë¶ˆí™•ì‹¤ì„±ì´ ì¤„ê³  â€˜ë‹¤ìŒ ë‹¨ê³„â€™ê°€ ëª…í™•í•´ì§")
    print("âœ” ì˜¨ë¼ì¸ ìƒë‹´ ì„ íƒ ë¹„ìœ¨ì´ ë†’ì„ìˆ˜ë¡ ì ‘ê·¼ì„±ì´ ì¢‹ì•„ì§")


# --------------------------------------------------------------
# 5) ë©”ì¸ ë©”ë‰´ (ë°˜ë³µë¬¸)
# --------------------------------------------------------------

def main_menu():
    """ì‚¬ìš©ìê°€ ì‹¤í–‰í•˜ëŠ” ë©”ì¸ ë©”ë‰´"""

    while True:
        print_line()
        print("ğŸ“ ì›”ì²œì´ ì§„ë¡œ ìƒë‹´ ë§¤ì¹­ í”„ë¡œê·¸ë¨")
        print("1) ìƒë‹´ ì˜ˆì•½í•˜ê¸°")
        print("2) êµìˆ˜ ì •ë³´ ë³´ê¸°")
        print("3) ìƒë‹´ ê¸°ë¡/ì§€í‘œ ë³´ê¸°")
        print("4) ì¢…ë£Œ")
        print_line()

        choice = input("ë©”ë‰´ ì„ íƒ: ")

        if choice == "1":
            book_consultation()
        elif choice == "2":
            show_professor_info()
        elif choice == "3":
            show_history_and_stats()
        elif choice == "4":
            print("í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œí•©ë‹ˆë‹¤. ì´ìš©í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!")
            break
        else:
            print("âš ï¸ ì˜¬ë°”ë¥¸ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")


# --------------------------------------------------------------
# í”„ë¡œê·¸ë¨ ì‹œì‘
# --------------------------------------------------------------
if __name__ == "__main__":
    main_menu()
