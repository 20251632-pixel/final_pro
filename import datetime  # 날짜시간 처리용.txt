import datetime  # ë‚ ì§œ/ì‹œê°„ ì²˜ë¦¬ìš©
import random    # Zoom ë¯¸íŒ… ID ìƒì„±ì„ ìœ„í•œ ëœë¤ ëª¨ë“ˆ


# -----------------------------
# ë°ì´í„° ì •ì˜ (ë¦¬ìŠ¤íŠ¸, ë”•ì…”ë„ˆë¦¬)
# -----------------------------

fields = {
    "ìŠ¤ë§ˆíŠ¸íŒ©í† ë¦¬/ì œì¡° ë°ì´í„°": [
        {"id": 1, "name": "ìŠ¤ë§ˆíŠ¸íŒ©í† ë¦¬ ì§„ë¡œ ìƒë‹´", "desc": "ìŠ¤ë§ˆíŠ¸íŒ©í† ë¦¬ì™€ ì œì¡° ì§ë¬´ ë¡œë“œë§µ ìƒë‹´"},
        {"id": 2, "name": "ì œì¡° ë°ì´í„° ë¶„ì„", "desc": "ê³µì • ë°ì´í„° ë¶„ì„ ê¸°ë°˜ ë¬¸ì œ í•´ê²° ìƒë‹´"},
        {"id": 3, "name": "ì„¤ë¹„Â·í’ˆì§ˆ ì—°ê³„ ê³ ë¯¼", "desc": "ì„¤ë¹„ê´€ë¦¬, í’ˆì§ˆ, ê³µì • ê°œì„  ì—°ê²° ìƒë‹´"},
    ],
    "ê²½ì˜ê³¼í•™": [
        {"id": 1, "name": "ìµœì í™”/ì˜ì‚¬ê²°ì • ëª¨ë¸", "desc": "ìˆ˜ë¦¬ì  ìµœì í™” ê¸°ë°˜ ì§„ë¡œ ìƒë‹´"},
        {"id": 2, "name": "SCM/ë¬¼ë¥˜ ë¶„ì„", "desc": "ê³µê¸‰ë§, ë¬¼ë¥˜ ì „ëµ ê´€ë ¨ ìƒë‹´"},
        {"id": 3, "name": "ìˆ˜í•™Â·ì½”ë”© ê¸°ë°˜ ì§„ë¡œ", "desc": "ìˆ˜í•™/í”„ë¡œê·¸ë˜ë° ì—­ëŸ‰ê³¼ ì§ë¬´ ì—°ê²°"},
    ],
    "ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤": [
        {"id": 1, "name": "ë°ì´í„° ë¶„ì„/ì‹œê°í™”", "desc": "íŒŒì´ì¬Â·BI ë„êµ¬ í™œìš© ë°ì´í„° ë¶„ì„"},
        {"id": 2, "name": "ë¨¸ì‹ ëŸ¬ë‹/ëª¨ë¸ë§", "desc": "ë¨¸ì‹ ëŸ¬ë‹ ê¸°ì´ˆ ë° í”„ë¡œì íŠ¸ ì£¼ì œ ìƒë‹´"},
        {"id": 3, "name": "ë°ì´í„° ê¸°ë°˜ ì§„ë¡œ ì„¤ê³„", "desc": "ë°ì´í„° ë¶„ì•¼ ì·¨ì—… ë¡œë“œë§µ ìƒë‹´"},
    ],
    "ì¸ê°„ê³µí•™": [
        {"id": 1, "name": "ì‘ì—… ì„¤ê³„/ì¸¡ì •", "desc": "ì‘ì—…í˜„ì¥ ê°œì„  ë° ì‘ì—…ì—°êµ¬ ìƒë‹´"},
        {"id": 2, "name": "ê°ì„±ê³µí•™/UX", "desc": "ì‚¬ìš©ì ì¤‘ì‹¬ ì„¤ê³„ ê´€ë ¨ ìƒë‹´"},
        {"id": 3, "name": "ì œí’ˆ ì„¤ê³„", "desc": "ì¸ì²´ê³µí•™ì  ì œí’ˆ ì„¤ê³„ ë° ì¸¡ì • ìƒë‹´"},
    ],
    "ìƒì‚°ì‹œìŠ¤í…œ": [
        {"id": 1, "name": "ìƒì‚°ìš´ì˜ê´€ë¦¬", "desc": "ìƒì‚°ê´€ë¦¬ ì§ë¬´ ì´í•´ ìƒë‹´"},
        {"id": 2, "name": "ê³µì • ê°œì„ ", "desc": "ìƒì‚°ì„± í–¥ìƒ ë° ê³µì • ì„¤ê³„ ìƒë‹´"},
        {"id": 3, "name": "ì‹œë®¬ë ˆì´ì…˜", "desc": "ì œì¡° ì‹œìŠ¤í…œ ì‹œë®¬ë ˆì´ì…˜ ì‘ìš© ìƒë‹´"},
    ],
    "ê¸°ìˆ ê²½ì˜": [
        {"id": 1, "name": "í˜ì‹  ì „ëµ", "desc": "ê¸°ìˆ í˜ì‹ /ì „ëµ ìˆ˜ë¦½ ê´€ë ¨ ìƒë‹´"},
        {"id": 2, "name": "ì‚¬ì—…í™”Â·ì°½ì—…", "desc": "ì•„ì´ë””ì–´ ìƒìš©í™” ë° ì°½ì—… ê³ ë¯¼ ìƒë‹´"},
        {"id": 3, "name": "ë°ì´í„° ê¸°ë°˜ ë§ˆì¼€íŒ…", "desc": "ë°ì´í„° í™œìš© ë§ˆì¼€íŒ… ì „ëµ ìƒë‹´"},
    ],
    "í†µê³„ë¶„ì„": [
        {"id": 1, "name": "í’ˆì§ˆ ë°ì´í„° ë¶„ì„", "desc": "ê³µì—…í†µê³„ ê¸°ë°˜ í’ˆì§ˆ ë¬¸ì œ ë¶„ì„ ìƒë‹´"},
        {"id": 2, "name": "ì‹œê³„ì—´/ìˆ˜ìš”ì˜ˆì¸¡", "desc": "ì˜ˆì¸¡ëª¨ë¸ ë° í”„ë¡œì íŠ¸ ìƒë‹´"},
        {"id": 3, "name": "í†µê³„ ì˜ì‚¬ê²°ì •", "desc": "í†µê³„ ê¸°ë°˜ ë¬¸ì œ í•´ê²° ìƒë‹´"},
    ],
}

# êµìˆ˜ ì •ë³´ ì—…ë°ì´íŠ¸ (ì´ë¦„ / ì „ê³µ / ì´ë©”ì¼ / ê°€ëŠ¥ ìš”ì¼ í¬í•¨)
professors = {
    "ë°±ìˆ˜ì •": {
        "field": "ìŠ¤ë§ˆíŠ¸íŒ©í† ë¦¬/ì œì¡° ë°ì´í„°",
        "specialty": "ìŠ¤ë§ˆíŠ¸íŒ©í† ë¦¬, ì œì¡° ë°ì´í„° ë¶„ì„",
        "email": "baek@univ.ac.kr",
        "office": "N4ë™ 211í˜¸",
        "intro": "ìŠ¤ë§ˆíŠ¸ ì œì¡° í˜ì‹  ë° í’ˆì§ˆ ë°ì´í„° ê¸°ë°˜ ë¬¸ì œ í•´ê²° ì—°êµ¬",
    },
    "ë¯¼ë³‘ì°¬": {
        "field": "ì¸ê°„ê³µí•™",
        "specialty": "ì‘ì—… ì„¤ê³„, ê°ì„±ê³µí•™",
        "email": "min@univ.ac.kr",
        "office": "N4ë™ 214í˜¸",
        "intro": "ì‚¬ìš©ì ì¤‘ì‹¬ ì„¤ê³„ë¥¼ í†µí•´ ì‚°ì—… ì•ˆì „ ë° ìƒì‚°ì„± í–¥ìƒ ì—°êµ¬",
    },
    "ë°°ì„±ë¯¼": {
        "field": "ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤",
        "specialty": "Data Mining, CRM",
        "email": "bae@univ.ac.kr",
        "office": "N4ë™ 210í˜¸",
        "intro": "ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì •ì„ ìœ„í•œ ì§€ëŠ¥í˜• ë¶„ì„ ì—°êµ¬",
    },
    "ë¥˜íƒœë²”": {
        "field": "ì¸ê°„ê³µí•™/ì œí’ˆì„¤ê³„",
        "specialty": "Biomechanics, Product Design",
        "email": "ryu@univ.ac.kr",
        "office": "N4ë™ 208í˜¸",
        "intro": "ì‚¬ëŒ ì¤‘ì‹¬ì˜ ì œí’ˆ ì„¤ê³„ ë° ì¸¡ì • ì—°êµ¬",
    },
    "ì‹ ë¬¸ìˆ˜": {
        "field": "ìƒì‚°ì‹œìŠ¤í…œ",
        "specialty": "ìƒì‚°ìš´ì˜ê´€ë¦¬, ì‹œë®¬ë ˆì´ì…˜",
        "email": "shin@univ.ac.kr",
        "office": "N4ë™ 209í˜¸",
        "intro": "ìƒì‚° íš¨ìœ¨ ê°œì„  ë° ìŠ¤ë§ˆíŠ¸ì œì¡° ìš´ì˜ ì—°êµ¬",
    },
    "ê¹€ê¸°íƒœ": {
        "field": "ê²½ì˜ê³¼í•™",
        "specialty": "Optimization, SCM",
        "email": "kimkt@univ.ac.kr",
        "office": "N4ë™ 207í˜¸",
        "intro": "ìµœì í™” ê¸°ë°˜ ê³µê¸‰ë§ ë¶„ì„ ë° ìš´ì˜ ì „ëµ ì—°êµ¬",
    },
    "ê¹€íƒœêµ¬": {
        "field": "í†µê³„ë¶„ì„",
        "specialty": "Applied Statistics, Forecasting",
        "email": "ktg@univ.ac.kr",
        "office": "N4ë™ 206í˜¸",
        "intro": "í†µê³„ ê¸°ë°˜ ìˆ˜ìš”ì˜ˆì¸¡ ë° íˆ¬ì ë¶„ì„ ì—°êµ¬",
    },
    "ê¹€ì¬ì„±": {
        "field": "ìŠ¤ë§ˆíŠ¸íŒ©í† ë¦¬/ì‹œë®¬ë ˆì´ì…˜",
        "specialty": "Modeling & Simulation",
        "email": "jaeseong@univ.ac.kr",
        "office": "N4ë™ 217í˜¸",
        "intro": "ë””ì§€í„¸ ì œì¡° ì‹œìŠ¤í…œ ë° ê³µì • ëª¨ë¸ë§ ì—°êµ¬",
    },
    "ê³½ê¸°í˜¸": {
        "field": "ê¸°ìˆ ê²½ì˜",
        "specialty": "Innovation Strategy, Tech-Business",
        "email": "kwak@univ.ac.kr",
        "office": "N4ë™ 212í˜¸",
        "intro": "ì‚°ì—… í˜ì‹ ê³¼ ê¸°ìˆ  ìƒìš©í™” ì „ëµ ì—°êµ¬",
    },
    "ì—¼ì¬ì„ ": {
        "field": "ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤",
        "specialty": "Data Mining, Network Science",
        "email": "yeom@univ.ac.kr",
        "office": "N4ë™ 216í˜¸",
        "intro": "ë³µì¡ ë„¤íŠ¸ì›Œí¬ ë¶„ì„ê³¼ ë°ì´í„° ê¸°ë°˜ ì˜ˆì¸¡ ì—°êµ¬",
    },
}

field_to_professors = {
    "ìŠ¤ë§ˆíŠ¸íŒ©í† ë¦¬/ì œì¡° ë°ì´í„°": ["ë°±ìˆ˜ì •", "ê¹€ì¬ì„±"],
    "ê²½ì˜ê³¼í•™": ["ê¹€ê¸°íƒœ"],
    "ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤": ["ë°°ì„±ë¯¼", "ì—¼ì¬ì„ "],
    "ì¸ê°„ê³µí•™": ["ë¯¼ë³‘ì°¬", "ë¥˜íƒœë²”"],
    "ìƒì‚°ì‹œìŠ¤í…œ": ["ì‹ ë¬¸ìˆ˜"],
    "ê¸°ìˆ ê²½ì˜": ["ê³½ê¸°í˜¸"],
    "í†µê³„ë¶„ì„": ["ê¹€íƒœêµ¬"],
}

professor_available_days = {
    "ë°±ìˆ˜ì •": ["ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ"],
    "ë¯¼ë³‘ì°¬": ["ì›”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† "],
    "ë°°ì„±ë¯¼": ["í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† "],
    "ë¥˜íƒœë²”": ["ì›”", "í™”", "ìˆ˜", "ê¸ˆ", "í† "],
    "ì‹ ë¬¸ìˆ˜": ["ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ"],
    "ê¹€ê¸°íƒœ": ["ì›”", "ìˆ˜", "ëª©", "ê¸ˆ", "ì¼"],
    "ê¹€íƒœêµ¬": ["í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† "],
    "ê¹€ì¬ì„±": ["ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ"],
    "ê³½ê¸°í˜¸": ["ì›”", "í™”", "ìˆ˜", "ëª©", "ì¼"],
    "ì—¼ì¬ì„ ": ["í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† "],
}


# -----------------------------
# í´ë˜ìŠ¤ ì •ì˜
# -----------------------------

class Consultation:
    def __init__(self, student_name, field, subtopic, mode, date_str, time_str, professor, zoom_link=None):
        self.student_name = student_name
        self.field = field
        self.subtopic = subtopic
        self.mode = mode
        self.date_str = date_str
        self.time_str = time_str
        self.professor = professor
        self.zoom_link = zoom_link
        self.created_at = datetime.datetime.now()

    def summary(self):
        base = f"[{self.field} - {self.subtopic['name']}] {self.date_str} {self.time_str}, {self.mode}, ìƒë‹´ì‚¬: {self.professor}"
        if self.mode == "ì˜¨ë¼ì¸(ZOOM)" and self.zoom_link:
            base += f" (Zoom ë§í¬: {self.zoom_link})"
        return base


consultation_history = []


# -----------------------------
# ìœ í‹¸ í•¨ìˆ˜
# -----------------------------

def print_line():
    print("-" * 60)

def generate_zoom_link():
    meeting_id = random.randint(10**9, 10**10 - 1)
    return f"https://zoom.us/j/{meeting_id}"

def get_weekday_korean(date_str):
    try:
        dt = datetime.datetime.strptime(date_str, "%Y-%m-%d")
    except ValueError:
        return None
    weekday_names = ["ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† ", "ì¼"]
    return weekday_names[dt.weekday()]


# -----------------------------
# ë©”ë‰´ ê¸°ëŠ¥
# -----------------------------

def show_professor_info():
    print_line()
    print("ğŸ“˜ ìƒë‹´ ê°€ëŠ¥í•œ êµìˆ˜(ìƒë‹´ì‚¬) ì •ë³´")
    print_line()
    for name, info in professors.items():
        print(f"ì´ë¦„: {name}")
        print(f"ì „ë¬¸ ë¶„ì•¼: {info['field']} ({info['specialty']})")
        print(f"ì´ë©”ì¼: {info['email']}")
        print(f"ì—°êµ¬ì‹¤: {info['office']}")
        print(f"ìƒë‹´ ê°€ëŠ¥ ìš”ì¼: {', '.join(professor_available_days[name])}")
        print(f"ì†Œê°œ: {info['intro']}")
        print_line()


def select_field():
    print_line()
    print("ìƒë‹´ ë°›ì„ ë¶„ì•¼ë¥¼ ì„ íƒí•˜ì„¸ìš”.")
    fields_list = list(fields.keys())
    for i, f in enumerate(fields_list, start=1):
        print(f"{i}) {f}")
    num = input("ë²ˆí˜¸ ì…ë ¥: ")
    if num.isdigit() and 1 <= int(num) <= len(fields_list):
        return fields_list[int(num) - 1]
    return select_field()


def select_subtopic(field_name):
    print_line()
    print(f"ğŸ“‚ [{field_name}] ì„¸ë¶€ ì£¼ì œ ì„ íƒ")
    for item in fields[field_name]:
        print(f"{item['id']}) {item['name']} - {item['desc']}")
    num = input("ë²ˆí˜¸ ì…ë ¥: ")
    for item in fields[field_name]:
        if str(item["id"]) == num:
            return item
    return select_subtopic(field_name)


def select_professor(field_name):
    print_line()
    print(f"ğŸ“˜ [{field_name}] ìƒë‹´ ê°€ëŠ¥ êµìˆ˜")
    prof_list = field_to_professors[field_name]
    for i, p in enumerate(prof_list, start=1):
        print(f"{i}) {p} - ê°€ëŠ¥ ìš”ì¼: {', '.join(professor_available_days[p])}")
    num = input("ë²ˆí˜¸ ì„ íƒ: ")
    if num.isdigit() and 1 <= int(num) <= len(prof_list):
        return prof_list[int(num) - 1]
    return prof_list[0]


def select_mode():
    print_line()
    print("ìƒë‹´ ë°©ì‹ ì„ íƒ")
    print("1) ì˜¨ë¼ì¸(ZOOM)")
    print("2) ì˜¤í”„ë¼ì¸(ëŒ€ë©´)")
    ch = input("ë²ˆí˜¸ ì…ë ¥: ")
    if ch == "1":
        return "ì˜¨ë¼ì¸(ZOOM)"
    elif ch == "2":
        return "ì˜¤í”„ë¼ì¸(ëŒ€ë©´)"
    return select_mode()


def input_date_time(professor):
    print_line()
    print(f"ğŸ—“ ìƒë‹´ ê°€ëŠ¥ ìš”ì¼: {', '.join(professor_available_days[professor])}")

    while True:
        date_str = input("ë‚ ì§œ ì…ë ¥ (ì˜ˆ: 2025-12-01): ")
        weekday = get_weekday_korean(date_str)
        if weekday is None:
            print("â— ì˜¬ë°”ë¥¸ ë‚ ì§œ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.")
            continue
        if weekday not in professor_available_days[professor]:
            print(f"â— {professor} êµìˆ˜ë‹˜ì€ {weekday}ìš”ì¼ì—ëŠ” ìƒë‹´ ë¶ˆê°€")
            continue

        time_str = input("ì‹œê°„ ì…ë ¥ (09:00~18:00): ")
        try:
            t = datetime.datetime.strptime(time_str, "%H:%M")
        except:
            print("â— ì˜¬ë°”ë¥¸ ì‹œê°„ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.")
            continue
        if not(9 <= t.hour <= 18):
            print("â— ìƒë‹´ ê°€ëŠ¥ ì‹œê°„ì€ 09:00~18:00ì…ë‹ˆë‹¤.")
            continue

        return date_str, time_str


# -----------------------------
# ìƒë‹´ ì˜ˆì•½
# -----------------------------

def book_consultation():
    print_line()
    print("ğŸ“Œ ì§„ë¡œ ìƒë‹´ ì˜ˆì•½ ì§„í–‰")
    name = input("ì´ë¦„ ì…ë ¥ (ê¸°ë³¸: ë°•ì›”ì²œ): ").strip() or "ë°•ì›”ì²œ"

    field_name = select_field()
    subtopic = select_subtopic(field_name)
    professor = select_professor(field_name)
    mode = select_mode()
    date_str, time_str = input_date_time(professor)

    zoom_link = generate_zoom_link() if mode == "ì˜¨ë¼ì¸(ZOOM)" else None

    consultation = Consultation(name, field_name, subtopic, mode, date_str, time_str, professor, zoom_link)
    consultation_history.append(consultation)

    print_line()
    print("ğŸ‰ ìƒë‹´ ì˜ˆì•½ ì™„ë£Œ!")
    print(consultation.summary())
    print_line()

    # ------------------------------------
    # âœ‰ï¸ ë©”ì¼ ìë™ ìƒì„± ê¸°ëŠ¥
    # ------------------------------------
    print("âœ‰ï¸ êµìˆ˜ë‹˜ê»˜ ë³´ë‚´ë©´ ë˜ëŠ” ë©”ì¼ ì˜ˆì‹œ")
    print_line()
    weekday = get_weekday_korean(date_str)
    prof_email = professors[professor]["email"]

    print(f"[ë©”ì¼ ì œëª©]")
    print(f"[ì§„ë¡œ ìƒë‹´ ìš”ì²­] {date_str}({weekday}) {time_str} / {field_name} / {name}")
    print()
    print("[ë©”ì¼ ë‚´ìš©]")
    print(f"{professor} êµìˆ˜ë‹˜, ì•ˆë…•í•˜ì„¸ìš”.")
    print(f"ì‚°ì—…ê²½ì˜ê³µí•™ê³¼ {name} í•™ìƒì…ë‹ˆë‹¤.")
    print("ì§„ë¡œ ìƒë‹´ ê´€ë ¨í•˜ì—¬ ì•„ë˜ì™€ ê°™ì´ ìƒë‹´ ê°€ëŠ¥ ì—¬ë¶€ ë¬¸ì˜ë“œë¦½ë‹ˆë‹¤.")
    print()
    print(f"- ë¶„ì•¼: {field_name}")
    print(f"- ì£¼ì œ: {subtopic['name']}")
    print(f"- ë°©ì‹: {mode}")
    print(f"- ì¼ì‹œ: {date_str}({weekday}) {time_str}")
    if zoom_link:
        print(f"- Zoom ë§í¬: {zoom_link}")
    print()
    print("ê°€ëŠ¥í•˜ì‹  ê²½ìš° íšŒì‹  ë¶€íƒë“œë¦½ë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤ :)")
    print()
    print(f"{name} ë“œë¦¼")
    print_line()
    print(f"ğŸ“§ êµìˆ˜ë‹˜ ì´ë©”ì¼: {prof_email}")
    print_line()

    print("í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œí•©ë‹ˆë‹¤. ì¢‹ì€ í•˜ë£¨ ë˜ì„¸ìš”! ğŸ˜Š")


# -----------------------------
# ë©”ì¸ ë©”ë‰´
# -----------------------------

def main_menu():
    while True:
        print_line()
        print("ğŸ“ ì›”ì²œì´ ì§„ë¡œ ìƒë‹´ ë§¤ì¹­ í”„ë¡œê·¸ë¨")
        print("1) ìƒë‹´ ì˜ˆì•½í•˜ê¸°")
        print("2) êµìˆ˜/ìƒë‹´ì‚¬ ì •ë³´ ë³´ê¸°")
        print("3) ì¢…ë£Œ")
        print_line()
        ch = input("ë²ˆí˜¸ ì…ë ¥: ")
        if ch == "1":
            book_consultation()
            break
        elif ch == "2":
            show_professor_info()
        elif ch == "3":
            print("í”„ë¡œê·¸ë¨ ì¢…ë£Œ ğŸ˜Š")
            break
        else:
            print("â— ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”.")


if __name__ == "__main__":
    main_menu()